function submitAction(e){e.preventDefault();var t=document.getElementById("notification");t.style.color="",t.innerHTML="Please wait...";var s=document.getElementById("getform");jQuery.post("getpass.php","userin="+s.querySelector("[name=userin]").value+"&account="+s.querySelector("[name=account]").value,updateEncrypted,"text")}function simpleAESDecrypt(e,t){var s=sjcl.codec.base64,n=sjcl.codec.hex,c=sjcl.codec.utf8String,r=n.fromBits(s.toBits(e)),o=r.substring(r.length-16);r=r.substring(0,r.length-16);var i=n.fromBits(sjcl.hash.sha256.hash(c.toBits(t))),a=sjcl.hash.sha256.hash(n.toBits(i+o)),d=n.toBits(i),l=r.substring(0,32);r=r.substring(32);var u=n.fromBits(sjcl.mode.cbc.decrypt(new sjcl.cipher.aes(a),n.toBits(r),n.toBits(l)));l=u.substring(0,32),u=u.substring(32);var m=c.fromBits(sjcl.mode.gcm.decrypt(new sjcl.cipher.aes(d),n.toBits(u),n.toBits(l)));return m.substring(0,m.length-m.charCodeAt(m.length-1))}function updateEncrypted(e){var t=document.getElementById("password_input").value,s=document.getElementById("notification"),n=e.split("\n")[0];if(sjcl.beware["CBC mode is dangerous because it doesn't protect message integrity."](),"VALID "==n.substring(0,6)){var c,r=sjcl.codec.utf8String.fromBits(sjcl.codec.base64.toBits(n.substring(6)));try{c=simpleAESDecrypt(r,t),s.style.color="green",s.innerHTML="Done.",document.getElementById("decrypted").value=c}catch(o){s.style.color="red",s.innerHTML="Incorrect password."}}else s.style.color="red",s.innerHTML="Entry doesn't exist."}function copyAction(){var e=document.getElementById("decrypted");e.disabled="",e.type="text",e.select(),document.execCommand("copy"),e.type="password",e.disabled="true"}