function submitAction(e){e.preventDefault();var t=document.getElementById("notification");t.style.color="",t.innerHTML="Please wait...";var s=document.getElementById("getform");jQuery.post("getpass.php","userin="+s.querySelector("[name=userin]").value+"&account="+s.querySelector("[name=account]").value,updateEncrypted,"text")}function simpleAESDecrypt(e,t){var s=sjcl.codec.base64,n=sjcl.codec.hex,r=sjcl.codec.utf8String,c=n.fromBits(s.toBits(e)),o=c.substring(c.length-16);c=c.substring(0,c.length-16);var i=n.fromBits(sjcl.hash.sha256.hash(r.toBits(t))),a=sjcl.hash.sha256.hash(n.toBits(i+o)),l=n.toBits(i),d=c.substring(0,32);c=c.substring(32);var u=n.fromBits(sjcl.mode.cbc.decrypt(new sjcl.cipher.aes(a),n.toBits(c),n.toBits(d)));d=u.substring(0,32),u=u.substring(32);var m=r.fromBits(sjcl.mode.gcm.decrypt(new sjcl.cipher.aes(l),n.toBits(u),n.toBits(d)));return m.substring(0,m.length-m.charCodeAt(m.length-1))}function updateEncrypted(e){var t=document.getElementById("password_input").value,s=document.getElementById("notification"),n=e.split("\n")[0];if(sjcl.beware["CBC mode is dangerous because it doesn't protect message integrity."](),"VALID "==n.substring(0,6)){var r,c=n.substring(6);try{r=simpleAESDecrypt(c,t),s.style.color="green",s.innerHTML="Done.",document.getElementById("decrypted").value=r}catch(o){s.style.color="red",s.innerHTML="Incorrect password."}}else s.style.color="red",s.innerHTML="Error getting entry: "+n}function copyAction(){var e=document.getElementById("decrypted");e.disabled="",e.type="text",e.select(),document.execCommand("copy"),e.type="password",e.disabled="true"}