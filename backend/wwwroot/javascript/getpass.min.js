function submitAction(e){e.preventDefault();var t=document.getElementById("notification");t.style.color="",t.innerHTML="Please wait...";var c=document.getElementById("getform");jQuery.post("getpass.php","userin="+c.querySelector("[name=userin]").value+"&account="+c.querySelector("[name=account]").value,updateEncrypted,"text")}function updateEncrypted(e){var t=document.getElementById("password_input").value,c=document.getElementById("notification"),s=sjcl.hash.sha256.hash(t),n=e.split("\n"),o=n[0],r=(n[1],n[2]);if(sjcl.beware["CBC mode is dangerous because it doesn't protect message integrity."](),"VALID "==o.substring(0,6)){var i=sjcl.codec.hex.fromBits(sjcl.codec.base64.toBits(o.substring(6))),d=sjcl.codec.hex.toBits(i.substring(0,i.length-32-64)),l=i.substring(i.length-64),a=sjcl.codec.hex.toBits(i.substring(i.length-32-64,i.length-64)),u=r.split("-"),m=(u[1],u[2]);if("cbc"==m){var y;try{y=sjcl.codec.utf8String.fromBits(sjcl.mode.cbc.decrypt(new sjcl.cipher.aes(s),d,a))}catch(p){y=""}l==sjcl.codec.hex.fromBits(sjcl.hash.sha256.hash(y))?(c.style.color="green",c.innerHTML="Done.",document.getElementById("decrypted").value=y):(c.style.color="red",c.innerHTML="Incorrect password.")}}else c.style.color="red",c.innerHTML="Entry doesn't exist."}function copyAction(){var e=document.getElementById("decrypted");e.disabled="",e.type="text",e.select(),document.execCommand("copy"),e.type="password",e.disabled="true"}